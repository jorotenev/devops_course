# Домашно
Цел - при качване на файл в S3 bucket, да се trigger-ва ламбда, която да показва съдържанието на качения файл.

Създайте S3 bucket, който да се казва - `<вашия IAM user name>-s3-progressbg-aws`. Може да го създадете през AWS UI Console-ата, през AWS CLI-a или през SDK-a - както ви е най-удобно :)

След това, създайте Lambda функция, която:
* да се казва `<вашия IAM user name>-lambda-progressbg-aws`
* като IAM role за вашата Lambda използвайте `progressbg-lambda-role` (вече съм я създал за вас).
* задайте 10 секунди за execution timeout
* кода на ламбдата можете да го пишете директно в browser-а или първо да го напишете локално и после да го копирате в code editor-a на Lambda-та.
* настройте вашата Lambda да се trigger-ва от S3 при качване на файл в даден bucket. Задайте bucket-a, който създадохте горе.


Когато има такъв trigger, всеки път, когато се upload-не файл във вашия S3 bucket, ще се прати event към вашата lambda, който ще съдържа името на bucket-a, в който се е качил файл и името на самия файл (+ още meta данни).

Единственото, което вашата Lambda трябва да прави е да прочете съдържанието на файла, който е бил качен в S3, и да го принтира. 

При проблеми ми пишете.  Настроил съм акаунта през IAM така че да не можете да виждате решенията на останалите. Ако виждате Access Denied или друга грешка - пишете ми.


## Hints
* Тестване - докато пишете кода ще искате да можете лесно да тествате дали работи правилно. За това често взимам съдържанието на някакъв примерен trigger event и го ползвам, докато пиша кода на моята ламбда. По този начин мога да тествам и локално (на моя компютър) и няма нужда някой trigger наистина да trigger-ва ламбдата - достатъчно е да имам съдържанието на примерен event.
* тестване на кода на ламбдата локално
  * можете да тествате вашия код локално - трябва да имате `lambda_handler(event, context)` метод - той ще бъде изпълняван когато Lambda извика вашия код. Под `if __name__ == '__main':` можете да сложите тестов код, който да извика вашия метод с тестов event. Това е удобен трик, защото позволява да тествате вашата ламбда локално като изпълните python файла. Код в споменатия `if` блок ще бъде изпълнен само когато скрипта се извика директно. По този начин, когато качите вашия код в Lambda, тестовия код в if блока няма да бъде изпълнен.

Примерен код, който принтира съдържанието на файл от s3.
```python
import boto3
bucketname, itemname = 'your bucket', 'your_item.txt'
s3 = boto3.resource('s3')
obj = s3.Object(bucketname, itemname)
body = obj.get()['Body'].read()
print(body)
```
Когато сте написали вашия код, създали сте Lambda функция, качили сте кода ви в ламбдата и сте добавили Trigger, който да trigger-ва ламбдата ви от Add new file event в даден S3 bucket - вече може да пробвате да качите файл в S3 и да видите какви логове е написала вашата ламбда.  

За да видите какво е принтирала вашата ламбда, отидете в Monitoring таб-а, след това отворете View logs in CloudWatch, Search Log Group. След това може да изберете, например последните 5 минути.

* за да качите файл в S3  
    * през CLI - `aws s3 cp some_local_file.txt s3://somebucketname`
    * през UI-a - отивате в Services -> S3, отивате в bucket-a и после Upload File.
